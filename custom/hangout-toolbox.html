<link rel="import" href="hangout-app.html">
<polymer-element name='hangout-toolbox'  extends="hangout-app" attributes="apikey">
    <template>
      <link rel="stylesheet" href="hangout-toolbox.css">
      <core-toolbar class="medium-tall">
          <img src="../img/toolbox-32.png" width="24" style="margin-right:5px; vertical-align: top;">
          <span class="bold">Hangout</span> <span class="light"> Toolbox</span>
        <div class="bottom fit" horizontal layout>
            <paper-tabs selected="{{page}}" valueattr='id' flex class="green" style="max-width: 400px;">
              <paper-tab id="lowerthird">
                <core-icon icon="account-box"></core-icon>
              </paper-tab>
              <paper-tab id="presets">
                <core-icon icon="list"></core-icon>
              </paper-tab>
              <paper-tab id="volumecontrol">
                <core-icon icon="av:volume-up"></core-icon>
              </paper-tab>
              <paper-tab id="about">
                <core-icon icon="info-outline"></core-icon>
              </paper-tab>
              <paper-tab id="settings">
                <core-icon icon="settings"></core-icon>
              </paper-tab>
            </paper-tabs>
        </div>
      </core-toolbar>

      <core-animated-pages selected="{{page}}" valueattr="id" transitions="slide-from-right">
        <section id="lowerthird">
            <div class="header">
              <h3>Lower Third</h3>
              <paper-toggle-button class="headerswitch"></paper-toggle-button>
              <paper-icon-button icon="device:screen-rotation" id="mirror" class="small"></paper-icon-button>
            </div>
            <paper-input floatingLabel id="displayName" class="lowerthird" label="Display Name" value={{participant}}></paper-input>
            <paper-input floatingLabel class="lowerthird" label="Tagline"></paper-input>
            <paper-button class="red" label="CHOOSE LOGO" raisedButton style="clear: both; margin-left: 25px; margin-bottom: 20px"></paper-button>
            <hr>
            <div class="header">
              <h3>Custom Overlay</h3>
              <paper-toggle-button class="headerswitch"></paper-toggle-button><br>
            </div>
            <paper-button class="red" label="UPLOAD" raisedButton style="margin-left: 25px; margin-bottom: 10px"></paper-button>
        </section>
        <section id="presets">
          <div class="header">
              <h3>Presets</h3>
          </div>
          <paper-input floatingLabel class="preset" label="Preset Name"></paper-input>
          <paper-icon-button icon="add" class="big"></paper-icon-button>
          <div style="height:487px; overflow-x:hidden;">
            <div class="preset-item-name">Preset 1</div>
            <div class="preset-item-buttons">
              <paper-radio-button style="height:26px;"></paper-radio-button><paper-icon-button icon="delete"></paper-icon-button>
            </div>

            <div class="preset-item-name">Preset 2</div>
            <div class="preset-item-buttons">
              <paper-radio-button style="height:26px;"></paper-radio-button><paper-icon-button icon="delete"></paper-icon-button>
            </div>

            <div class="preset-item-name">Preset 3</div>
            <div class="preset-item-buttons">
              <paper-radio-button style="height:26px;"></paper-radio-button><paper-icon-button icon="delete"></paper-icon-button>
            </div>

            <div class="preset-item-name">Preset 4</div>
            <div class="preset-item-buttons">
              <paper-radio-button style="height:26px;"></paper-radio-button><paper-icon-button icon="delete"></paper-icon-button>
            </div>

            <div class="preset-item-name">Preset 5</div>
            <div class="preset-item-buttons">
              <paper-radio-button style="height:26px;"></paper-radio-button><paper-icon-button icon="delete"></paper-icon-button>
            </div>
          </div>
        </section>
        <section id="volumecontrol" class="green-slider">
          <div class="header">
              <h3>Volume Control</h3>
              <paper-toggle-button class="headerswitch"></paper-toggle-button><br>
          </div>
          <img class="profile-logo" src="../img/profile.png"><paper-slider pin value="50"></paper-slider>
          <img class="profile-logo" src="../img/profile.png"><paper-slider pin value="50"></paper-slider>
          <img class="profile-logo" src="../img/profile.png"><paper-slider pin value="50"></paper-slider>
          <img class="profile-logo" src="../img/profile.png"><paper-slider pin value="50"></paper-slider>
          <img class="profile-logo" src="../img/profile.png"><paper-slider pin value="50"></paper-slider>
          <img class="profile-logo" src="../img/profile.png"><paper-slider pin value="50"></paper-slider>
          <img class="profile-logo" src="../img/profile.png"><paper-slider pin value="50"></paper-slider>
          <img class="profile-logo" src="../img/profile.png"><paper-slider pin value="50"></paper-slider>
          <img class="profile-logo" src="../img/profile.png"><paper-slider pin value="50"></paper-slider>
        </section>
        <section id="about">
          <div class="header">
              <h3>About</h3>
          </div>
          <p style="margin-left: 25px; font-size: 14px">
          Hangout Toolbox provides useful applications to improve your Hangout experience.<br><br>
For an even better experience,<br> try <a href="https://www.google.com/chrome/" target="_blank">Google Chrome</a><br><br>
Version: 2.0.1
          </p>
          <h3>Support</h3>
        </section>
        <section id="settings">
          <div class="header">
              <h3>Settings</h3>
          </div>
          <div style="margin-left: 25px; float: left; font-size: 14px;">Enable Auto Load</div><paper-checkbox style="float:right; margin-right: 20px"></paper-checkbox>
          <div style="clear: both; margin-top: 15px;"></div>
          <div style="margin-left: 25px; float: left; font-size: 14px">Mute sounds</div><paper-checkbox style="float:right; margin-right: 20px"></paper-checkbox>
          <div style="clear: both; margin-top: 15px;"></div>
          <div style="margin-left: 25px; float: left; font-size: 14px">Use last Lowerthird</div><paper-checkbox style="float:right; margin-right: 20px"></paper-checkbox>
        </section>
      </core-animated-pages>
    </template>
    <script>
        var globalShow = false;
        var overlays = {};
        var canvas = null;
        if(typeof FileReader !== "undefined"){
           var fileReader = new FileReader();
        }

        function getParticipant() {
          var uid = gapi.hangout.getLocalParticipantId();
          var p = gapi.hangout.getParticipants();
          for(i = 0; i < p.length; i++) {
            if(p[i].id == uid){
              var user = p[i].person.displayName;
              return user;
            }
          }
        }

        function toggleMirror() {
          gapi.hangout.av.setLocalParticipantVideoMirrored(!gapi.hangout.av.isLocalParticipantVideoMirrored());
        }

        Polymer("hangout-toolbox", {
          ready: function(){
            // scrape the state off the window location
            this.page = location.hash.slice(1)|| 'lowerthird';
            // listen for 'back' events
            addEventListener('popstate', this.popstate.bind(this));

            var mirrorButton = this.$.mirror;

            mirrorButton.addEventListener('click', function(){
              toggleMirror();
            });
            
          },
          readyCallback: function() {
            this.participant = getParticipant();
            //init();
          },
          pageChanged: function() {
            // if the selected page changes, push a state (unless we are going backward)
            if (this.poppedPage !== this.page) {
              history.pushState(this.page, "Title", '#' + this.page);
            }
          },
          popstate: function(event) {
            // comes here whether we went 'back' from code or UI
            this.poppedPage = this.page = event.state;
          },
          back: function(){
            // support custom UI for back
            history.back();
          }
        });
    </script>
  </polymer-element>